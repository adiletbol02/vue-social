"use strict";(self["webpackChunkvue_social"]=self["webpackChunkvue_social"]||[]).push([[990],{6262:function(e,a){a.A=(e,a)=>{const l=e.__vccOpts||e;for(const[u,t]of a)l[u]=t;return l}},7990:function(e,a,l){l.r(a),l.d(a,{default:function(){return w}});l(4114);var u=l(641),t=l(33),o=l(3751),s=l(953),i=l(2780),n=l(5904),v=l(1884),r=l(5220);const d=e=>((0,u.Qi)("data-v-12a1d643"),e=e(),(0,u.jt)(),e),c={key:0},p=["src"],f=d((()=>(0,u.Lk)("strong",null,"Display Name:",-1))),m=d((()=>(0,u.Lk)("strong",null,"Email:",-1))),k=d((()=>(0,u.Lk)("strong",null,"Bio:",-1))),b={key:0,class:"text-error"};var y={__name:"ProfilePage",setup(e){const a=(0,r.rd)(),l=(0,i.xI)(),d=(0,n.c7)(),y=(0,v.aU)(),g=(0,s.KR)(!1),_=(0,s.KR)(null),w=(0,s.KR)(""),R=(0,s.KR)(""),h=(0,s.KR)(!1),x=(0,s.KR)(null),U=(0,s.KR)(null),L=(0,s.KR)(l.currentUser);(0,u.sV)((async()=>{const e=(0,v.H9)(y,"users",L.value.uid),a=await(0,v.x7)(e);if(L.value&&await F(),a.exists()){const e=a.data();w.value=e.displayName||"",L.value.bio=e.bio||""}else console.warn("User document not found in Firestore!")}));const F=async()=>{const e=(0,v.H9)(y,"users",L.value.uid),a=await(0,v.x7)(e);if(a.exists()){const e=a.data();w.value=e.displayName||"",U.value=e.bio||""}else console.warn("User document not found in Firestore!")};(0,u.wB)(g,(e=>{e&&(R.value=U.value||"")}));const N=async()=>{h.value=!0,x.value=null;try{const e=l.currentUser,u={},t=(0,v.H9)(y,"users",e.uid);if(_.value){const a=(0,n.KR)(d,`profile-images/${e.uid}`);await(0,n.D)(a,_.value);const l=await(0,n.qk)(a);u.photoURL=l}if(w.value!==e.displayName){u.displayName=w.value;const a=await(0,v.x7)(t);if(a.exists()){const l=a.data().displayName;await(0,v.kd)((0,v.H9)(y,"usernames",l)),await(0,v.BN)((0,v.H9)(y,"usernames",w.value),{uid:e.uid})}}await Promise.all([(0,i.r7)(e,u),(0,v.mZ)(t,{displayName:w.value,bio:R.value,..._.value&&{photoURL:u.photoURL}})]),U.value=R.value,u.photoURL&&e.value&&(e.value.photoURL=u.photoURL),a.push("/vue-social/profile")}catch(e){x.value=e.message}finally{h.value=!1}},W=()=>{g.value=!1,w.value=L.value.displayName||"",R.value=L.value.bio||"",_.value=null};return(e,a)=>{const l=(0,u.g2)("v-btn"),s=(0,u.g2)("v-card-title"),i=(0,u.g2)("v-file-input"),n=(0,u.g2)("v-text-field"),v=(0,u.g2)("v-textarea"),r=(0,u.g2)("v-form"),d=(0,u.g2)("v-card-text"),y=(0,u.g2)("v-card"),F=(0,u.g2)("v-col"),V=(0,u.g2)("v-row"),K=(0,u.g2)("v-container");return(0,u.uX)(),(0,u.Wv)(K,null,{default:(0,u.k6)((()=>[(0,u.bF)(V,{justify:"center"},{default:(0,u.k6)((()=>[(0,u.bF)(F,{cols:"12",md:"6"},{default:(0,u.k6)((()=>[(0,u.bF)(y,{class:"pa-5"},{default:(0,u.k6)((()=>[g.value?((0,u.uX)(),(0,u.Wv)(s,{key:1,class:"text-h5 text-center"},{default:(0,u.k6)((()=>[(0,u.eW)(" Edit Profile ")])),_:1})):((0,u.uX)(),(0,u.Wv)(s,{key:0,class:"text-h5 text-center"},{default:(0,u.k6)((()=>[(0,u.eW)(" My Profile "),(0,u.bF)(l,{onClick:a[0]||(a[0]=e=>g.value=!0),color:"primary",small:""},{default:(0,u.k6)((()=>[(0,u.eW)("Edit")])),_:1})])),_:1})),(0,u.bF)(d,null,{default:(0,u.k6)((()=>[g.value?((0,u.uX)(),(0,u.Wv)(r,{key:1,onSubmit:(0,o.D$)(N,["prevent"])},{default:(0,u.k6)((()=>[(0,u.bF)(i,{modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=e=>_.value=e),label:"Profile Image",accept:"image/*"},null,8,["modelValue"]),(0,u.bF)(n,{modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=e=>w.value=e),label:"Display Name",required:""},null,8,["modelValue"]),(0,u.bF)(v,{modelValue:R.value,"onUpdate:modelValue":a[3]||(a[3]=e=>R.value=e),label:"Bio",rows:"3"},null,8,["modelValue"]),(0,u.bF)(l,{type:"submit",color:"primary",disabled:h.value},{default:(0,u.k6)((()=>[(0,u.eW)(" Save Changes ")])),_:1},8,["disabled"]),(0,u.bF)(l,{onClick:W,color:"secondary",disabled:h.value},{default:(0,u.k6)((()=>[(0,u.eW)(" Cancel ")])),_:1},8,["disabled"]),x.value?((0,u.uX)(),(0,u.CE)("div",b,(0,t.v_)(x.value),1)):(0,u.Q3)("",!0)])),_:1})):((0,u.uX)(),(0,u.CE)("div",c,[(0,u.Lk)("img",{src:L.value.photoURL||"default-profile.png",alt:"Profile Picture",class:"profile-image"},null,8,p),(0,u.Lk)("p",null,[f,(0,u.eW)(" "+(0,t.v_)(L.value.displayName),1)]),(0,u.Lk)("p",null,[m,(0,u.eW)(" "+(0,t.v_)(L.value.email),1)]),(0,u.Lk)("p",null,[k,(0,u.eW)(" "+(0,t.v_)(U.value||"No bio yet."),1)])]))])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}}},g=l(6262);const _=(0,g.A)(y,[["__scopeId","data-v-12a1d643"]]);var w=_}}]);
//# sourceMappingURL=990.e079bf58.js.map